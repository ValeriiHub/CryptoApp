//
//  MarketData.swift
//  CryptoApp
//
//  Created by Valerii on 30.06.2024.
//

import Foundation


// MARK: - GlobalData
struct GlobalData: Codable {
    let data: MarketData?
}

// MARK: - MarketData
struct MarketData: Codable {
    let totalMarketCap, totalVolume, marketCapPercentage: [String: Double]
    let marketCapChangePercentage24HUsd: Double

    enum CodingKeys: String, CodingKey {
        case totalMarketCap = "total_market_cap"
        case totalVolume = "total_volume"
        case marketCapPercentage = "market_cap_percentage"
        case marketCapChangePercentage24HUsd = "market_cap_change_percentage_24h_usd"
    }
    
    var marketCap: String {
        if let item = totalMarketCap.first(where: { $0.key == "usd" }) {
            return "$" + item.value.formattedWithAbbreviations()
        }
        return ""
    }
    
    var volume: String {
        if let item = totalVolume.first(where: { $0.key == "usd" }) {
            return "$" + item.value.formattedWithAbbreviations()
        }
        return ""
    }
    
    var btcDominance: String {
        if let item = marketCapPercentage.first(where: { $0.key == "btc" }) {
            return item.value.asPercentString()
        }
        return ""
    }
}


/*
 https://api.coingecko.com/api/v3/global
 
 {
 "data": {
 "active_cryptocurrencies": 14855,
 "upcoming_icos": 0,
 "ongoing_icos": 49,
 "ended_icos": 3376,
 "markets": 1148,
 "total_market_cap": {
 "btc": 38881897.05598471,
 "eth": 703694514.8584387,
 "ltc": 32302555070.19935,
 "bch": 6197227022.322929,
 "bnb": 4157795905.1565747,
 "eos": 4193050674435.3994,
 "xrp": 5065624853642.55,
 "xlm": 26613289776474.99,
 "link": 174643915223.78247,
 "dot": 391011347639.4522,
 "yfi": 372084248.5588568,
 "usd": 2395879964403.1387,
 "aed": 8800067109252.729,
 "ars": 2183844587553463.2,
 "aud": 3582353265095.0776,
 "bdt": 281260816061078.56,
 "bhd": 902295582234.1138,
 "bmd": 2395879964403.1387,
 "brl": 13401059887653.32,
 "cad": 3281037817251.88,
 "chf": 2163441273776.603,
 "clp": 2288328553419087.5,
 "cny": 17411578465306.945,
 "czk": 55985727464070.4,
 "dkk": 16679876724178.232,
 "eur": 2235902267420.012,
 "gbp": 1893602896905.738,
 "gel": 6708463900328.784,
 "hkd": 18709546436022.332,
 "huf": 882962776375912.9,
 "idr": 39173715563975480,
 "ils": 8991898030362.582,
 "inr": 199738882314373.44,
 "jpy": 385461148072999,
 "krw": 3309381077230770,
 "kwd": 734219810971.3058,
 "lkr": 732476190160173.9,
 "mmk": 5946358442451814,
 "mxn": 43937084315203.35,
 "myr": 11302563732071.791,
 "ngn": 3368607229950813,
 "nok": 25427270412413.543,
 "nzd": 3933800105313.4585,
 "php": 139943334345507.6,
 "pkr": 666151255943037.4,
 "pln": 9640807743441.412,
 "rub": 205223612188803.78,
 "sar": 8988701926490.092,
 "sek": 25398723502637.695,
 "sgd": 3250011171712.859,
 "thb": 87896241872518.88,
 "try": 78472256474096,
 "twd": 77912818502408.08,
 "uah": 96830471072138.3,
 "vef": 239899460835.68646,
 "vnd": 60987153206107460,
 "zar": 43603973144352.65,
 "xdr": 1817780483672.2715,
 "xag": 82222455505.97728,
 "xau": 1029725249.9008245,
 "bits": 38881897055984.71,
 "sats": 3888189705598471.5
 },
 "total_volume": {
 "btc": 725874.2784304642,
 "eth": 13137058.29406601,
 "ltc": 603046549.3820915,
 "bch": 115694141.32806657,
 "bnb": 77620623.76151809,
 "eos": 78278784297.63217,
 "xrp": 94568605542.64662,
 "xlm": 496835390653.50757,
 "link": 3260373992.627036,
 "dot": 7299671603.400439,
 "yfi": 6946327.362811375,
 "usd": 44727952390.36442,
 "aed": 164285769129.8085,
 "ars": 40769528603817.21,
 "aud": 66877860605.406395,
 "bdt": 5250772399688.625,
 "bhd": 16844681054.068382,
 "bmd": 44727952390.36442,
 "brl": 250180300157.35907,
 "cad": 61252694400.98458,
 "chf": 40388625361.2608,
 "clp": 42720107898368.11,
 "cny": 325051448406.4956,
 "czk": 1045180472209.7947,
 "dkk": 311391531746.4784,
 "eur": 41741377553.354996,
 "gbp": 35351094995.34368,
 "gel": 125238266693.0203,
 "hkd": 349282816613.9753,
 "huf": 16483762797375.508,
 "idr": 731322149161037.2,
 "ils": 167867002093.84756,
 "inr": 3728864280096.566,
 "jpy": 7196056620323.779,
 "krw": 61781826077762.61,
 "kwd": 13706925737.979557,
 "lkr": 13674374612803.893,
 "mmk": 111010752317169.72,
 "mxn": 820248027705.936,
 "myr": 211004115401.54385,
 "ngn": 62887501060852.37,
 "nok": 474693956842.9845,
 "nzd": 73438914485.64442,
 "php": 2612559430753.472,
 "pkr": 12436174642841.219,
 "pln": 179981299631.06393,
 "rub": 3831257029458.9673,
 "sar": 167807335005.35928,
 "sek": 474161023290.25354,
 "sgd": 60673467417.52936,
 "thb": 1640908134037.2468,
 "try": 1464974624641.6057,
 "twd": 1454530647758.4597,
 "uah": 1807698534317.0586,
 "vef": 4478609872.847193,
 "vnd": 1138550564116509,
 "zar": 814029276845.3433,
 "xdr": 33935589486.045807,
 "xag": 1534985946.679671,
 "xau": 19223626.657854713,
 "bits": 725874278430.4642,
 "sats": 72587427843046.42
 },
 "market_cap_percentage": {
 "btc": 50.71441851617393,
 "eth": 17.08276458604032,
 "usdt": 4.700133481711457,
 "bnb": 3.701448565998984,
 "sol": 2.7684908318692383,
 "steth": 1.3806574414737554,
 "usdc": 1.3447245816226587,
 "xrp": 1.0986719685758952,
 "ton": 0.7814522329276593,
 "doge": 0.7421933394297427
 },
 "market_cap_change_percentage_24h_usd": 0.8624824903299658,
 "updated_at": 1719769799
 }
 }
 */
